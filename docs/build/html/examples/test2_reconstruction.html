

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reconstruction Comparison — Monochromatic Wave Propagation &mdash; WavePropError v1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=e160b93e"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Scheme Comparison — Monochromatic Wave Propagation" href="test1_scheme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            WavePropError
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules/scheme_description.html">Description of Numerical Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/scripts.html">Python Scripts Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/code.html">C++ Code Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules/examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test1_scheme.html">Scheme Comparison — Monochromatic Wave Propagation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reconstruction Comparison — Monochromatic Wave Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Imports">Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#User-input">User input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Wave-parameters">Wave parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Numerical-settings">Numerical settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Model-runs">Model runs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-order-flux-reconstruction">First-order flux reconstruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Second-order-flux-reconstruction">Second-order flux reconstruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Third-order-flux-reconstruction">Third-order flux reconstruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Fifth-order-flux-reconstruction">Fifth-order flux reconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Exact-Solution">Exact Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting">Plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Full-animation">Full animation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Figure-of-the-final-time-step">Figure of the final time step</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WavePropError</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../modules/examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Reconstruction Comparison — Monochromatic Wave Propagation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/test2_reconstruction.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Reconstruction-Comparison-—-Monochromatic-Wave-Propagation">
<h1>Reconstruction Comparison — Monochromatic Wave Propagation<a class="headerlink" href="#Reconstruction-Comparison-—-Monochromatic-Wave-Propagation" title="Link to this heading"></a></h1>
<p>This notebook compares the solutions of linear monochromatic wave propagation using different orders of flux reconstruction. The HLLC scheme is consistently used for flux calculations.</p>
<section id="Imports">
<h2>Imports<a class="headerlink" href="#Imports" title="Link to this heading"></a></h2>
<p>First, we need to set the working directory to the main WavePropError directory to import the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> module.</p>
<p>We import <code class="docutils literal notranslate"><span class="pre">plotly.io</span> <span class="pre">as</span> <span class="pre">pio</span></code> to save the interactive Plotly plot as an HTML file. The <code class="docutils literal notranslate"><span class="pre">IPython.display.IFrame</span></code> is used to display this HTML file within the documentation, making the interactive plot accessible directly from the Sphinx-generated documentation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">maindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;../../..&quot;</span><span class="p">))</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">maindir</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scripts</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">IFrame</span>
</pre></div>
</div>
</div>
</section>
<section id="User-input">
<h2>User input<a class="headerlink" href="#User-input" title="Link to this heading"></a></h2>
<p>We define the wave parameters and numerical settings for the model runs, which will be used consistently across all model runs.</p>
<section id="Wave-parameters">
<h3>Wave parameters<a class="headerlink" href="#Wave-parameters" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave_amplitude</span> <span class="o">=</span> <span class="mf">1e-2</span> <span class="c1"># wave amplitude in m, small amplitude assumption</span>
<span class="n">wave_period</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># wave period in s</span>
<span class="n">water_depth</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># water depth in m</span>

<span class="n">wave_length</span> <span class="o">=</span> <span class="n">wavelength_nwogu</span><span class="p">(</span><span class="n">wave_period</span><span class="p">,</span> <span class="n">water_depth</span><span class="p">)</span> <span class="c1"># wave length in m computed using Nwogu&#39;s dispersion relation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Wave length: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wave_length</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Wave length: 12.00
</pre></div></div>
</div>
</section>
<section id="Numerical-settings">
<h3>Numerical settings<a class="headerlink" href="#Numerical-settings" title="Link to this heading"></a></h3>
<p>We define the key dimensionless parameters that control the spatial and temporal resolution of the wave simulation:</p>
<ul>
<li><div class="line-block">
<div class="line"><strong>``points_per_wl``</strong>: Number of grid points per wavelength.</div>
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\texttt{points_per_wl} = \frac{\lambda}{\Delta x}\]</div>
</div></blockquote>
</li>
<li><div class="line-block">
<div class="line"><strong>``domain_wl``</strong>: Domain length in terms of the number of wavelengths.</div>
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\texttt{domain_wl} = \frac{L}{\lambda}\]</div>
</div></blockquote>
</li>
<li><div class="line-block">
<div class="line"><strong>``duration_tp``</strong>: Simulation time in number of wave periods.</div>
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\texttt{duration_tp} = \frac{T_{sim}}{T}\]</div>
</div></blockquote>
</li>
</ul>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength,</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x\)</span> is the grid spacing,</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> is the domain length</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{sim}\)</span> is the simulation time,</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is the wave period.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_per_wl</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">domain_wl</span>  <span class="o">=</span> <span class="mi">30</span>
<span class="n">duration_tp</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">courant_number</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># courant number</span>
<span class="n">order_rk</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># order of Runge-Kutta time integration</span>

<span class="n">grid_size</span> <span class="o">=</span> <span class="n">wave_length</span> <span class="o">/</span> <span class="n">points_per_wl</span>
<span class="n">domain_size</span> <span class="o">=</span> <span class="n">wave_length</span> <span class="o">*</span> <span class="n">domain_wl</span>
<span class="n">run_time</span> <span class="o">=</span> <span class="n">wave_period</span> <span class="o">*</span> <span class="n">duration_tp</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Grid size: </span><span class="si">{:.2f}</span><span class="s1"> m&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid_size</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Domain size: </span><span class="si">{:.2f}</span><span class="s1"> m&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">domain_size</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Simulation time: </span><span class="si">{:.2f}</span><span class="s1"> s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">run_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Grid size: 0.40 m
Domain size: 360.00 m
Simulation time: 200.00 s
</pre></div></div>
</div>
</section>
</section>
<section id="Model-runs">
<h2>Model runs<a class="headerlink" href="#Model-runs" title="Link to this heading"></a></h2>
<p>We use the function <code class="docutils literal notranslate"><span class="pre">run_model</span></code> from the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> module to run the model. For more details on the function, please refer to the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> module documentation.</p>
<section id="First-order-flux-reconstruction">
<h3>First-order flux reconstruction<a class="headerlink" href="#First-order-flux-reconstruction" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_first</span> <span class="o">=</span> <span class="n">run_sine_wave</span><span class="p">(</span>
    <span class="n">name_run</span><span class="o">=</span><span class="s2">&quot;first_order&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="n">hllc</span><span class="p">,</span>
    <span class="n">order_reconstruction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">order_time_integration</span><span class="o">=</span><span class="n">order_rk</span><span class="p">,</span>
    <span class="n">courant_number</span><span class="o">=</span><span class="n">courant_number</span><span class="p">,</span>
    <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size</span><span class="p">,</span>
    <span class="n">domain_size</span><span class="o">=</span><span class="n">domain_size</span><span class="p">,</span>
    <span class="n">water_depth</span><span class="o">=</span><span class="n">water_depth</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="n">wave_amplitude</span><span class="p">,</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">wave_period</span><span class="p">,</span>
    <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
    <span class="n">output_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gauges_locations</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">gauges_dt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running first_order...

Input parameters
----------------
Numerical scheme :hllc
Order of reconstruction :1
Order of RK time integration :3
Courant number :0.5
Grid spacing :0.400003 m
Length of the domain :360.002 m
Water depth :1 m
Total computation time :200 s
Time step for the output :1 s
Time step for the gauges :1 s
frequency [Hz]           amplitude [m]            phase [rad]
0.25                     0.01                     0

Computation Progress:
100% [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||]

The numerical simulation took 7.73504 s


Reading first_order results and converting to xarray.Dataset...
Done!
</pre></div></div>
</div>
</section>
<section id="Second-order-flux-reconstruction">
<h3>Second-order flux reconstruction<a class="headerlink" href="#Second-order-flux-reconstruction" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_second</span> <span class="o">=</span> <span class="n">run_sine_wave</span><span class="p">(</span>
    <span class="n">name_run</span><span class="o">=</span><span class="s2">&quot;second_order&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="n">hllc</span><span class="p">,</span>
    <span class="n">order_reconstruction</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">order_time_integration</span><span class="o">=</span><span class="n">order_rk</span><span class="p">,</span>
    <span class="n">courant_number</span><span class="o">=</span><span class="n">courant_number</span><span class="p">,</span>
    <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size</span><span class="p">,</span>
    <span class="n">domain_size</span><span class="o">=</span><span class="n">domain_size</span><span class="p">,</span>
    <span class="n">water_depth</span><span class="o">=</span><span class="n">water_depth</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="n">wave_amplitude</span><span class="p">,</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">wave_period</span><span class="p">,</span>
    <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
    <span class="n">output_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gauges_locations</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">gauges_dt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running second_order...

Input parameters
----------------
Numerical scheme :hllc
Order of reconstruction :2
Order of RK time integration :3
Courant number :0.5
Grid spacing :0.400003 m
Length of the domain :360.002 m
Water depth :1 m
Total computation time :200 s
Time step for the output :1 s
Time step for the gauges :1 s
frequency [Hz]           amplitude [m]            phase [rad]
0.25                     0.01                     0

Computation Progress:
100% [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||]

The numerical simulation took 7.88994 s


Reading second_order results and converting to xarray.Dataset...
Done!
</pre></div></div>
</div>
</section>
<section id="Third-order-flux-reconstruction">
<h3>Third-order flux reconstruction<a class="headerlink" href="#Third-order-flux-reconstruction" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_third</span> <span class="o">=</span> <span class="n">run_sine_wave</span><span class="p">(</span>
    <span class="n">name_run</span><span class="o">=</span><span class="s2">&quot;third_order&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="n">hllc</span><span class="p">,</span>
    <span class="n">order_reconstruction</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">order_time_integration</span><span class="o">=</span><span class="n">order_rk</span><span class="p">,</span>
    <span class="n">courant_number</span><span class="o">=</span><span class="n">courant_number</span><span class="p">,</span>
    <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size</span><span class="p">,</span>
    <span class="n">domain_size</span><span class="o">=</span><span class="n">domain_size</span><span class="p">,</span>
    <span class="n">water_depth</span><span class="o">=</span><span class="n">water_depth</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="n">wave_amplitude</span><span class="p">,</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">wave_period</span><span class="p">,</span>
    <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
    <span class="n">output_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gauges_locations</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">gauges_dt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running third_order...

Input parameters
----------------
Numerical scheme :hllc
Order of reconstruction :3
Order of RK time integration :3
Courant number :0.5
Grid spacing :0.400003 m
Length of the domain :360.002 m
Water depth :1 m
Total computation time :200 s
Time step for the output :1 s
Time step for the gauges :1 s
frequency [Hz]           amplitude [m]            phase [rad]
0.25                     0.01                     0

Computation Progress:
100% [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||]

The numerical simulation took 7.85848 s


Reading third_order results and converting to xarray.Dataset...
Done!
</pre></div></div>
</div>
</section>
<section id="Fifth-order-flux-reconstruction">
<h3>Fifth-order flux reconstruction<a class="headerlink" href="#Fifth-order-flux-reconstruction" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_fifth</span> <span class="o">=</span> <span class="n">run_sine_wave</span><span class="p">(</span>
    <span class="n">name_run</span><span class="o">=</span><span class="s2">&quot;fifth_order&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="o">=</span><span class="n">hllc</span><span class="p">,</span>
    <span class="n">order_reconstruction</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">order_time_integration</span><span class="o">=</span><span class="n">order_rk</span><span class="p">,</span>
    <span class="n">courant_number</span><span class="o">=</span><span class="n">courant_number</span><span class="p">,</span>
    <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size</span><span class="p">,</span>
    <span class="n">domain_size</span><span class="o">=</span><span class="n">domain_size</span><span class="p">,</span>
    <span class="n">water_depth</span><span class="o">=</span><span class="n">water_depth</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="n">wave_amplitude</span><span class="p">,</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">wave_period</span><span class="p">,</span>
    <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
    <span class="n">output_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gauges_locations</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">gauges_dt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running fifth_order...

Input parameters
----------------
Numerical scheme :hllc
Order of reconstruction :5
Order of RK time integration :3
Courant number :0.5
Grid spacing :0.400003 m
Length of the domain :360.002 m
Water depth :1 m
Total computation time :200 s
Time step for the output :1 s
Time step for the gauges :1 s
frequency [Hz]           amplitude [m]            phase [rad]
0.25                     0.01                     0

Computation Progress:
100% [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||]

The numerical simulation took 7.67825 s


Reading fifth_order results and converting to xarray.Dataset...
Done!
</pre></div></div>
</div>
</section>
</section>
<section id="Exact-Solution">
<h2>Exact Solution<a class="headerlink" href="#Exact-Solution" title="Link to this heading"></a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">exact_solution</span></code> computes the exact solution of the linear wave propgation based on Nwogu’s equation. For more details on the function, please refer to the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> module documentation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_exact</span> <span class="o">=</span> <span class="n">sine_wave_exact_solution</span><span class="p">(</span>
    <span class="n">water_depth</span><span class="o">=</span><span class="n">water_depth</span><span class="p">,</span>
    <span class="n">wave_amplitude</span><span class="o">=</span><span class="n">wave_amplitude</span><span class="p">,</span>
    <span class="n">wave_period</span><span class="o">=</span><span class="n">wave_period</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">ds_first</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">ds_first</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
    <span class="n">time_gauges</span><span class="o">=</span><span class="n">ds_first</span><span class="o">.</span><span class="n">time_gauges</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">index_gauges</span><span class="o">=</span><span class="n">ds_first</span><span class="o">.</span><span class="n">index_gauges</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting">
<h2>Plotting<a class="headerlink" href="#Plotting" title="Link to this heading"></a></h2>
<section id="Full-animation">
<h3>Full animation<a class="headerlink" href="#Full-animation" title="Link to this heading"></a></h3>
<p>We create an interactive plot using Plotly to visualize the results of the model runs. The user can click on the legend to toggle the visibility of each model run result and zoom in/out on the plot.</p>
<p>The animation embedded in the Sphix-generated documentation may appear glitchy initially. To fix this, click “Stop,” then go back to the beginning and play again. This issue does not occur when the script is run locally.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">create_animation_plotly</span><span class="p">([</span><span class="n">ds_first</span><span class="p">,</span> <span class="n">ds_second</span><span class="p">,</span> <span class="n">ds_third</span><span class="p">,</span> <span class="n">ds_fifth</span><span class="p">],</span> <span class="n">ds_exact</span><span class="p">)</span>

<span class="c1"># Additional formatting of the fig object</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">yaxis_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">pio</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;docs/source/_static/test2_sine_wave.html&quot;</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">&quot;../_static/test2_sine_wave.html&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;500px&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<iframe
    width="100%"
    height="500px"
    src="../_static/test2_sine_wave.html"
    frameborder="0"
    allowfullscreen

></iframe></div>
</div>
</section>
<section id="Figure-of-the-final-time-step">
<h3>Figure of the final time step<a class="headerlink" href="#Figure-of-the-final-time-step" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_exact</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">wave_length</span><span class="p">,</span> <span class="n">ds_exact</span><span class="o">.</span><span class="n">eta</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">wave_amplitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact Solution&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_first</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">wave_length</span><span class="p">,</span> <span class="n">ds_first</span><span class="o">.</span><span class="n">eta</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">wave_amplitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;First-Order Reconstruction&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_second</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">wave_length</span><span class="p">,</span> <span class="n">ds_second</span><span class="o">.</span><span class="n">eta</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">wave_amplitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Second-Order Reconstruction&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_third</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">wave_length</span><span class="p">,</span> <span class="n">ds_third</span><span class="o">.</span><span class="n">eta</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">wave_amplitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Third-Order Reconstruction&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds_fifth</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">wave_length</span><span class="p">,</span> <span class="n">ds_fifth</span><span class="o">.</span><span class="n">eta</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">wave_amplitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fifth-Order Reconstruction&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x / \lambda_0$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\eta / a_0$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wave propagation at t = </span><span class="si">{:.2f}</span><span class="s2"> s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ds_first</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_test2_reconstruction_24_0.png" src="../_images/examples_test2_reconstruction_24_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="test1_scheme.html" class="btn btn-neutral float-left" title="Scheme Comparison — Monochromatic Wave Propagation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Fatima-Zahra Mihami.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>